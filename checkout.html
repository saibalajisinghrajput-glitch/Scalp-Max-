<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Scalp Max</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <i class="fas fa-leaf"></i> Scalp Max
            </a>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="index.html#product">Product</a>
                <a href="index.html#benefits">Benefits</a>
                <a href="index.html#reviews">Reviews</a>
                <a href="index.html#faq">FAQ</a>
            </div>
            <div class="cart-icon">
                <i class="fas fa-shopping-cart"></i>
                <span id="cart-count">1</span>
            </div>
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <div class="mobile-menu" id="mobileMenu">
            <a href="index.html">Home</a>
            <a href="index.html#product">Product</a>
            <a href="index.html#benefits">Benefits</a>
            <a href="index.html#reviews">Reviews</a>
            <a href="index.html#faq">FAQ</a>
        </div>
    </nav>

    <!-- Checkout Hero -->
    <section class="hero" style="min-height: auto; padding: 140px 20px 40px;">
        <div class="hero-content">
            <span class="badge"><i class="fas fa-shield-alt"></i> Secure Checkout</span>
            <h2 class="highlight">Complete Your Order</h2>
            <p class="hero-description">Fill in your details below to place your order for Scalp Max Hair Care Kit</p>
            <div class="trust-badges">
                <span><i class="fas fa-lock"></i> 100% Secure</span>
                <span><i class="fas fa-truck"></i> Free Delivery</span>
                <span><i class="fas fa-undo"></i> Easy Returns</span>
            </div>
        <div class="hero-image">
            <div class="product-container">
                <div class="product-glow"></div>
                <div class="product-bottle">
                    <img src="product-image.png" alt="Scalp Max Product">
                </div>
        </div>
    </section>

    <!-- Checkout Form Section -->
    <section class="order-section" style="padding: 40px 20px 80px;">
        <div class="container">
            <div class="order-card">
                <div class="order-header" style="background: linear-gradient(135deg, #2d5a27 0%, #4a8c42 100%);">
                    <h2><i class="fas fa-clipboard-check"></i> Order Summary</h2>
                    <p>Review your order details</p>
                </div>
                <div class="order-content">
                    <div class="product-info">
                        <img src="product-image.png" alt="Scalp Max Product">
                        <div class="product-details">
                            <h3><i class="fas fa-spa"></i> Scalp Max Hair Care Kit</h3>
                            <p>Advanced hair growth formula with natural ingredients</p>
                            <div class="price-info">
                                <span class="price">₹499</span>
                                <span class="mrp">MRP ₹999</span>
                                <span class="save">50% OFF</span>
                            </div>
                    </div>

                    <form id="checkoutForm">
                        <!-- Personal Information -->
                        <div class="section-title" style="text-align: left; font-size: 1.3rem; margin: 30px 0 20px;">
                            <i class="fas fa-user-circle"></i> Personal Information
                        </div>
                        
                        <div class="form-group">
                            <label for="name"><i class="fas fa-user"></i> Full Name *</label>
                            <input type="text" id="name" name="name" required placeholder="Enter your full name">
                        </div>

                        <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div class="form-group">
                                <label for="email"><i class="fas fa-envelope"></i> Email Address *</label>
                                <input type="email" id="email" name="email" required placeholder="Enter your email">
                            </div>
                            <div class="form-group">
                                <label for="phone"><i class="fas fa-phone-alt"></i> Phone Number *</label>
                                <input type="tel" id="phone" name="phone" required placeholder="Enter your phone number">
                            </div>

                        <!-- Delivery Address -->
                        <div class="section-title" style="text-align: left; font-size: 1.3rem; margin: 30px 0 20px;">
                            <i class="fas fa-map-marker-alt"></i> Delivery Address
                        </div>
                        
                        <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                            <div class="form-group">
                                <label for="city"><i class="fas fa-city"></i> City *</label>
                                <input type="text" id="city" name="city" required placeholder="City">
                            </div>
                            <div class="form-group">
                                <label for="state"><i class="fas fa-map"></i> State *</label>
                                <input type="text" id="state" name="state" required placeholder="State">
                            </div>
                            <div class="form-group">
                                <label for="pincode"><i class="fas fa-map-pin"></i> Pincode *</label>
                                <input type="text" id="pincode" name="pincode" required placeholder="Pincode">
                            </div>

                        <div class="form-group">
                            <label for="address"><i class="fas fa-home"></i> Full Address *</label>
                            <textarea id="address" name="address" required placeholder="Enter your complete delivery address" rows="3"></textarea>
                        </div>

                        <!-- Payment Method -->
                        <div class="section-title" style="text-align: left; font-size: 1.3rem; margin: 30px 0 20px;">
                            <i class="fas fa-credit-card"></i> Select Payment Method
                        </div>
                        
                        <div class="payment-method-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 25px;">
                            <label class="payment-card" onclick="selectPayment('UPI')">
                                <input type="radio" name="payment" value="UPI" checked>
                                <div class="payment-card-content">
                                    <i class="fas fa-mobile-alt"></i>
                                    <span>UPI</span>
                                    <small>Pay via Google Pay, PhonePe, etc.</small>
                                </div>
                            </label>
                            <label class="payment-card" onclick="selectPayment('COD')">
                                <input type="radio" name="payment" value="COD">
                                <div class="payment-card-content">
                                    <i class="fas fa-money-bill-wave"></i>
                                    <span>COD</span>
                                    <small>Pay when you receive</small>
                                </div>
                            </label>
                            <label class="payment-card" onclick="selectPayment('WHATSAPP')">
                                <input type="radio" name="payment" value="WHATSAPP">
                                <div class="payment-card-content">
                                    <i class="fab fa-whatsapp"></i>
                                    <span>WhatsApp</span>
                                    <small>Order via WhatsApp</small>
                                </div>
                            </label>
                        </div>

                        <!-- Payment Details -->
                        <div id="paymentDetails" class="payment-details" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 25px; border-radius: 12px; margin-bottom: 25px;">
                            <!-- UPI Section -->
                            <div id="upiSection" style="display: block;">
                                <h4 style="color: var(--primary-color); margin-bottom: 15px;"><i class="fas fa-qrcode"></i> UPI Payment Details</h4>
                                <p style="margin-bottom: 15px;">Transfer <strong>₹499</strong> to:</p>
                                <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                    <p style="font-size: 1.1rem; margin-bottom: 10px;">UPI ID:</p>
                                    <p style="font-size: 1.4rem; font-weight: 700; color: var(--primary-color);">saibalajisinghrajput@oksbi</p>
                                </div>
                            
                            <!-- COD Section -->
                            <div id="codSection" style="display: none;">
                                <h4 style="color: var(--primary-color); margin-bottom: 15px;"><i class="fas fa-money-bill-wave"></i> Cash on Delivery</h4>
                                <p style="margin-bottom: 15px;">No advance payment required!</p>
                                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                    <p style="margin-bottom: 10px;"><i class="fas fa-check-circle" style="color: #28a745;"></i> Pay ₹499 at the time of delivery</p>
                                    <p style="margin-bottom: 10px;"><i class="fas fa-check-circle" style="color: #28a745;"></i> Our delivery partner will collect the payment</p>
                                    <p><i class="fas fa-check-circle" style="color: #28a745;"></i> Easy and risk-free</p>
                                </div>

                            <!-- WhatsApp Section -->
                            <div id="whatsappSection" style="display: none;">
                                <h4 style="color: #25D366; margin-bottom: 15px;"><i class="fab fa-whatsapp"></i> Order via WhatsApp</h4>
                                <p style="margin-bottom: 15px;">Click below to send your order on WhatsApp:</p>
                                <a href="https://wa.me/919010988498?text=Hi,%20I%20want%20to%20order%20Scalp%20Max%20Hair%20Care%20Kit.%20Price:%20₹499" 
                                   target="_blank" 
                                   style="display: inline-flex; align-items: center; gap: 10px; background: #25D366; color: white; padding: 15px 30px; border-radius: 10px; text-decoration: none; font-weight: 600; font-size: 1.1rem;">
                                    <i class="fab fa-whatsapp" style="font-size: 1.4rem;"></i>
                                    Order on WhatsApp
                                </a>
                            </div>

                        <!-- Order Total -->
                        <div class="order-total" style="background: linear-gradient(135deg, #2d5a27 0%, #4a8c42 100%); color: white; padding: 25px; border-radius: 12px; margin-bottom: 25px;">
                            <span style="font-size: 1.2rem;"><i class="fas fa-receipt"></i> Total Amount to Pay:</span>
                            <span style="font-size: 2rem; font-weight: 700;">₹499</span>
                        </div>

                        <button type="submit" class="btn btn-primary btn-block" style="font-size: 1.2rem; padding: 20px 32px; background: linear-gradient(135deg, #2d5a27 0%, #4a8c42 100%);">
                            <i class="fas fa-check-circle"></i> Place Order - ₹499
                        </button>

                        <p style="text-align: center; margin-top: 15px; font-size: 0.9rem; color: #666;">
                            <i class="fas fa-shield-alt"></i> Your information is secure and encrypted
                        </p>
                    </form>
                </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3><i class="fas fa-leaf"></i> Scalp Max</h3>
                    <p>Premium hair care solution for healthy, beautiful hair.</p>
                </div>
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <a href="index.html">Home</a>
                    <a href="index.html#product">Product</a>
                    <a href="index.html#benefits">Benefits</a>
                    <a href="index.html#reviews">Reviews</a>
                </div>
                <div class="footer-social">
                    <h4>Connect With Us</h4>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Scalp Max. All rights reserved. Made with <i class="fas fa-heart"></i> for your hair.</p>
            </div>
    </footer>

    <!-- Scripts -->
    <script src="config.js"></script>
    <script>
        // Payment method selection
        function selectPayment(method) {
            // Hide all sections
            document.getElementById('upiSection').style.display = 'none';
            document.getElementById('codSection').style.display = 'none';
            document.getElementById('whatsappSection').style.display = 'none';
            
            // Show selected section
            if (method === 'UPI') {
                document.getElementById('upiSection').style.display = 'block';
            } else if (method === 'COD') {
                document.getElementById('codSection').style.display = 'block';
            } else if (method === 'WHATSAPP') {
                document.getElementById('whatsappSection').style.display = 'block';
            }
        }

        // Mobile menu toggle
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('active');
        }

        // Checkout form handler
        document.getElementById('checkoutForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            const city = document.getElementById('city').value;
            const state = document.getElementById('state').value;
            const pincode = document.getElementById('pincode').value;
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
            
            const now = new Date();
            const orderId = 'ORD-' + Date.now();

            const orderData = {
                order_id: orderId,
                name: name,
                email: email,
                phone: phone,
                address: address,
                city: city,
                state: state,
                pincode: pincode,
                quantity: '1',
                total: '499',
                payment: paymentMethod,
                status: 'pending',
                created_at: now.toISOString()
            };

            console.log('Sending order data:', orderData);

            // For WhatsApp orders, redirect to WhatsApp
            if (paymentMethod === 'WHATSAPP') {
                const message = `Hi, I want to order Scalp Max Hair Care Kit.\n\nOrder Details:\nName: ${name}\nPhone: ${phone}\nAddress: ${address}, ${city}, ${state} - ${pincode}\nEmail: ${email}\nPayment: WhatsApp\n\nPlease confirm my order.`;
                window.open(`https://wa.me/919010988498?text=${encodeURIComponent(message)}`, '_blank');
                return;
            }

            try {
                const { data, error } = await supabaseClient
                    .from('orders')
                    .insert(orderData);

                if (error) {
                    console.error('Supabase error:', error);
                    // Still redirect to thank you page even if Supabase fails
                    localStorage.setItem('lastOrderId', orderId);
                    localStorage.setItem('paymentMethod', paymentMethod);
                    window.location.href = 'thank-you.html';
                    return;
                }

                console.log('Order saved successfully:', data);
                
                localStorage.setItem('lastOrderId', orderId);
                localStorage.setItem('paymentMethod', paymentMethod);
                window.location.href = 'thank-you.html';
            } catch (err) {
                console.error('Error placing order:', err);
                // Still redirect to thank you page on error
                localStorage.setItem('lastOrderId', orderId);
                localStorage.setItem('paymentMethod', paymentMethod);
                window.location.href = 'thank-you.html';
            }
        });
    </script>
</body>
</html>
